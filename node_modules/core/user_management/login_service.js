/**
 * Service for creating users
 * @author kvermeer
 */

// Dependencies
var bcrypt = require('bcrypt');
var User = require('./models/user.js');

var LoginService = function() {}

/**
 * Attempts to login a user
 * @param {string} email - email for user
 * @param {string} password - password for logging into user account
 * @return {Promise}
 */
LoginService.prototype.checkLoginCredentials = function(email, password) {

    return User.find({
        login: email,
    }).then(function(user) {
        var userPasswordHash = user.get('password_hash');
        if (bcrypt.compareSync(password, userPasswordHash)) { // Credentials are correct
            return {
                success: true,
                userId: user.get('user_id')
            }
        } else {
            return {
                success: false
            }
        }
    });
}

module.exports = LoginService;
