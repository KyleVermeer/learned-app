/**
 * Service for creating users
 * @author kvermeer
 */

// Dependencies
var bcrypt = require('bcrypt');
var User = require('./models/user.js');

var UserCreationService = function() {}

/**
 * @param {string} name - username for user
 * @param {string} email - email for user
 * @param {string} password - password for logging into user account
 * @param {function} callback - callback function to be called when query is issued.
 *                              function should take a boolean indicated success or failure
 * @return {void}
 */
UserCreationService.prototype.createUser = function(username, email, password, callback) {

    var passwordSalt = 10;
    var passwordHash = bcrypt.hashSync(password, passwordSalt);

    User.create({
        display_name: username,
        login: email,
        password_salt: passwordSalt,
        password_hash: passwordHash
    }).then(function(user) {
        callback(true);
    });
}

module.exports = UserCreationService;
